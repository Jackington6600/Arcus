/* Mobile TOC Components */
.toc-toggle {
	display: none;
	align-items: center;
	gap: 10px;
	background: var(--surface);
	border: 1px solid var(--border-light);
	border-radius: 10px;
	padding: 12px 14px;
	font-weight: 600;
	font-size: 20px;
	color: var(--text-primary);
	box-shadow: 0 3px 12px var(--shadow-light);
	width: auto !important;
	min-width: fit-content;
}

.toc-toggle svg { 
	width: 18px; 
	height: 18px; 
}

/* Page Menu */
.page-menu {
	position: fixed;
	inset: 0 0 0 0;
	top: calc(var(--nav-height) + var(--layout-top-spacing));
	bottom: 0;
	transform: translateY(-8px);
	opacity: 0;
	pointer-events: none;
	transition: opacity .25s ease, transform .25s ease;
	background: linear-gradient(180deg, var(--overlay-medium), var(--overlay-light));
	border-bottom: 1px solid var(--border-light);
	z-index: 100;
	overflow: auto;
	display: flex;
	flex-direction: column;
}

.page-menu.open {
	opacity: 1;
	transform: translateY(0);
	pointer-events: auto;
}

.page-menu .menu-inner {
	width: min(1200px, 92%);
	margin: 0 auto;
	display: flex;
	flex-direction: column;
	gap: 10px;
	padding: 12px 0 16px;
}

/* Create a sticky container that holds both search and header */
.page-menu .sticky-header {
	position: sticky;
	top: 0;
	background: linear-gradient(180deg, var(--overlay-medium), var(--overlay-light));
	z-index: 20;
	width: calc(100% + 24px);
	left: -12px;
	box-sizing: border-box;
	border-bottom: 1px solid var(--border-light);
	padding: 0 12px;
	/* Ensure the sticky header covers the full width of TOC content */
	overflow: hidden;
}

.page-menu .searchbar {
	padding: 8px 0;
	width: 100%;
	box-sizing: border-box;
	/* Ensure search bar extends to full width of sticky header */
	min-width: 100%;
}

.page-menu .accordion-header {
	padding: 16px 14px;
	width: 100%;
	box-sizing: border-box;
	display: flex;
	justify-content: space-between;
	align-items: center;
	/* Ensure accordion header extends to full width of sticky header */
	min-width: 100%;
}

.page-menu .accordion-header span[aria-hidden] {
	font-size: 24px;
	line-height: 1;
	cursor: pointer;
	transition: color 0.2s ease;
	display: inline-block;
	padding: 4px;
	border-radius: 4px;
	transition: color 0.2s ease, background-color 0.2s ease;
}

.page-menu .accordion-header span[aria-hidden]:hover {
	color: var(--accent-2);
	background-color: var(--surface-secondary);
}

/* Mobile TOC Toggle */
@media (max-width: 1100px) {
	.toc-toggle {
		display: flex;
		position: fixed;
		right: 16px;
		bottom: 24px;
		z-index: 70;
		max-width: 86vw;
		width: auto !important;
		min-width: fit-content;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}
	
	.page-menu {
		top: calc(var(--nav-height) + 12px);
	}
	
	.page-menu .sticky-header {
		width: calc(100% + 24px);
		left: -12px;
		padding: 0 12px;
	}
	
	/* Hide desktop TOC on mobile when mobile menu is open */
	.layout .toc {
		display: none !important;
	}
	
	/* Ensure mobile page menu is properly positioned and styled */
	.page-menu {
		position: fixed;
		inset: 0 0 0 0;
		top: calc(var(--nav-height) + 12px);
		bottom: 0;
		transform: translateY(-8px);
		opacity: 0;
		pointer-events: none;
		transition: opacity .25s ease, transform .25s ease;
		background: linear-gradient(180deg, var(--overlay-medium), var(--overlay-light));
		border-bottom: 1px solid var(--border-light);
		z-index: 100;
		overflow: auto;
		display: flex;
		flex-direction: column;
	}
	
	.page-menu.open {
		opacity: 1;
		transform: translateY(0);
		pointer-events: auto;
	}
}

/* Mobile menu search results overlay */
.page-menu .search-results-overlay {
	position: relative;
	background: var(--surface);
	border: 1px solid var(--border-light);
	border-radius: 8px;
	box-shadow: 0 4px 16px var(--shadow-light);
	margin: 8px 0;
	max-height: calc(100vh - 400px);
	overflow: hidden;
}

.page-menu .search-results-overlay .accordion-item {
	border: none;
	border-radius: 0;
	box-shadow: none;
	margin-bottom: 0;
}

.page-menu .search-results-overlay .accordion-content {
	max-height: calc(100vh - 450px);
	overflow-y: auto;
	padding: 12px 14px;
}

/* Mobile-specific search results styling */
@media (max-width: 1100px) {
	.page-menu .search-results-overlay {
		margin: 8px 12px;
		border-radius: 8px;
		max-height: calc(100vh - 300px);
	}
	
	.page-menu .search-results-overlay .accordion-content {
		max-height: calc(100vh - 350px);
	}
}

/* Mobile menu search results specific styling */
.page-menu .search-results-overlay .accordion-content > div {
	padding: 8px 0;
	margin: 0;
	border-bottom: 1px solid var(--border-light);
}

.page-menu .search-results-overlay .accordion-content > div:last-child {
	border-bottom: none;
}
