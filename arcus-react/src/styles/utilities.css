/* Utility Classes and Animations */
/* Scroll Reveal */
.reveal { 
	opacity: 0; 
	transform: translateY(16px); 
	transition: opacity .6s ease, transform .6s ease; 
}

.reveal.visible { 
	opacity: 1; 
	transform: translateY(0); 
}

/* Z-index management for proper layering */
.navbar {
	z-index: 50;
}

.mobile-menu {
	z-index: 60;
}

.page-menu {
	z-index: 100;
}

.toc-toggle {
	z-index: 70;
}

/* Ensure proper layering on mobile */
@media (max-width: 1100px) {
	.mobile-menu {
		z-index: 60;
	}
	
	.page-menu {
		z-index: 1000;
	}
	
	.toc-toggle {
		z-index: 70;
	}
	
	/* Ensure desktop TOC is completely hidden on mobile */
	.layout .toc {
		z-index: -1 !important;
	}
}

/* Mobile page menu specific styling */
@media (max-width: 1100px) {
	.page-menu {
		position: fixed !important;
		inset: 0 0 0 0 !important;
		top: calc(var(--nav-height) + 12px) !important;
		bottom: 0 !important;
		transform: translateY(-8px);
		opacity: 0;
		pointer-events: none;
		transition: opacity .25s ease, transform .25s ease;
		background: linear-gradient(180deg, var(--overlay-medium), var(--overlay-light)) !important;
		border-bottom: 1px solid var(--border-light);
		z-index: 1000 !important;
		overflow: auto;
		display: flex;
		flex-direction: column;
	}
	
	.page-menu.open {
		opacity: 1;
		transform: translateY(0);
		pointer-events: auto;
	}
	
	/* Ensure the mobile page menu search is the only visible search */
	.page-menu .searchbar {
		display: flex !important;
		z-index: 1001 !important;
	}
	
	/* Hide any other search bars when mobile page menu is open */
	body.mobile-toc-open .layout .toc .searchbar,
	body.mobile-menu-open .layout .toc .searchbar {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
	}
	
	/* Hide regular TOC list in FullRules mobile TOC when searching */
	.page-menu.searching .menu-inner > a {
		display: none !important;
	}
	
	/* Hide Wiki TOC content when searching in mobile TOC */
	.page-menu.searching .wiki-toc {
		display: none !important;
	}
	
	/* Ensure search results take full height when searching */
	.page-menu.searching .search-results-overlay {
		flex: 1;
		min-height: calc(100vh - 300px);
	}
}

/* Ensure mobile TOC toggle button properly hides desktop TOC */
@media (max-width: 1100px) {
	/* When mobile TOC is open, hide desktop TOC completely */
	.layout .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
	}
	
	/* Ensure mobile page menu takes full precedence */
	.page-menu {
		z-index: 1000 !important;
	}
	
	/* Hide any potential duplicate search bars */
	.layout .toc .searchbar {
		display: none !important;
	}
}

/* Ensure mobile page menu completely hides desktop TOC */
@media (max-width: 1100px) {
	/* When any mobile menu is open, hide desktop TOC completely */
	body:has(.page-menu.open) .layout .toc,
	body:has(.mobile-menu.open) .layout .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
		z-index: -1 !important;
	}
	
	/* Fallback for browsers that don't support :has() */
	.layout .page-menu.open ~ .toc,
	.layout .page-menu.open + .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
		z-index: -1 !important;
	}
	
	/* Alternative approach: hide TOC when page-menu exists and is open */
	.layout:has(.page-menu.open) .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
		z-index: -1 !important;
	}
	
	/* Use body class approach for reliable targeting */
	body.mobile-toc-open .layout .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
		z-index: -1 !important;
	}
	
	/* Also hide TOC when mobile menu is open */
	body.mobile-menu-open .layout .toc {
		display: none !important;
		visibility: hidden !important;
		opacity: 0 !important;
		pointer-events: none !important;
		z-index: -1 !important;
	}
}
